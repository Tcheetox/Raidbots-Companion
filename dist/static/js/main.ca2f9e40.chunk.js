(this["webpackJsonpraidbots-extension"]=this["webpackJsonpraidbots-extension"]||[]).push([[0],{39:function(e,t,n){},42:function(e,t,n){},52:function(e,t,n){"use strict";n.r(t);var a=n(2),r=n(0),c=n(14),i=n.n(c),s=(n(39),n(13)),o=n.n(s),l=n(18),u=n(7),b=(n(41),n(42),null);try{!function(){try{return!!window.chrome&&(!!window.chrome.webstore||!!window.chrome.runtime)}catch(e){return!1}}()?function(){try{return"undefined"!==typeof InstallTrigger}catch(e){return!1}}&&(b=window.browser):b=window.chrome}catch(D){console.log("> APPLICATION NOT RUNNING AS EXTENSION")}function d(e,t){if(b&&["tabs"]in b){var n=(null===e.currentTarget?e.target:e.currentTarget.href).toString().replace("chrome-extension","https").replace("moz-extension","https");t?b.tabs.query({active:!0,currentWindow:!0},(function(e){b.tabs.update(e[0].id,{url:n})})):b.tabs.create({url:n}),e.preventDefault()}}var j=function(e){return d(e,!1)},f=function(e){return d(e,!0)},O=n(8),v=n(9),h=n(24),m=n(12),p=n(28),x=n(29);function g(){return Object(a.jsx)("div",{className:"loader-wrapper",children:Object(a.jsx)(x.a,{animation:"border",role:"status"})})}function y(e){var t=e.item,n=e.setIlvl;return Object(a.jsx)(m.a.Control,{type:"range",defaultValue:t.iLvl,step:"1",onChange:function(e){var a=t.iLvls.reduce((function(t,n){return Math.abs(n-e.currentTarget.value)<Math.abs(t-e.currentTarget.value)?n:t}));n(a)},min:t.miniLvl,max:t.maxiLvl,custom:!0})}var N=n(32),w=n.n(N),S=n(30),k=n.n(S);function L(e){var t=e.onItemChange,n=e.item,c=Object(r.useState)(),i=Object(u.a)(c,2),s=i[0],o=i[1],l=Object(r.useState)([]),d=Object(u.a)(l,2),f=d[0],h=d[1],m=Object(r.useState)([]),p=Object(u.a)(m,2),x=p[0],g=p[1];Object(r.useEffect)((function(){o(n.iLvl),h(n.selected),g(n.favorites)}),[n]);var N=function(e){t(Object(v.a)(Object(v.a)({},n),{},{iLvl:e,selected:f,favorites:x})),o(e)},S=function(){var e=x.indexOf(s),a=Object(O.a)(x);-1!==e?a.splice(e,1):a.push(s),g(a),t(Object(v.a)(Object(v.a)({},n),{},{iLvl:s,selected:f,favorites:a}))};return Object(a.jsxs)("div",{className:"item ".concat(f.includes(s)?"selected":""),onDoubleClick:function(){return e="# ".concat(n.slot,"=,id=").concat(n.id,",bonus_id=").concat(n.bonus.length>0&&n.bonus[n.iLvls.indexOf(s)]?n.bonus[n.iLvls.indexOf(s)].replaceAll(":","/"):"",",ilevel=").concat(s," # ADDED BY EXTENSION"),a=function(e){var a=Object(O.a)(f);f.includes(s)&&e?(a.splice(f.indexOf(s),1),h(a)):!f.includes(s)&&e&&(a.push(s),h(a)),t(Object(v.a)(Object(v.a)({},n),{},{iLvl:s,selected:a,favorites:x}))},r=!f.includes(s),void(b&&["tabs"]in b?b.tabs.query({active:!0,currentWindow:!0},(function(t){var n="var callMeBack = () => {\n            try{\n              var box = document.querySelector('textarea')\n              if (box && box.name === 'optimizeInput') {\n                var nativeInputValueSetter = Object.getOwnPropertyDescriptor(\n                  window.HTMLTextAreaElement.prototype,\n                  'value').set\n                nativeInputValueSetter.call(box, \n                ".concat(r?"('".concat(e,"' + '\\n' + box.value)"):"box.value.replace('".concat(e,"','')"),")\n                var ev2 = new Event('input', { bubbles: true })\n                box.dispatchEvent(ev2)\n                return true\n              }\n              return false\n            } catch (err) {\n              return false\n            }\n          } \n        callMeBack()");b.tabs.executeScript(t[0].id,{code:n},(function(e){return a(void 0!==e&&void 0!==e[0]&&e[0])}))})):(console.log(e),a(!0)));var e,a,r},children:[Object(a.jsx)("a",{onClick:j,href:"//www.wowhead.com/item=".concat(n.id,"?bonus=").concat(n.bonus[n.iLvls.indexOf(s)],"&ilvl=").concat(s),target:"_blank",rel:"noreferrer",children:Object(a.jsx)("img",{alt:n.icon,src:"https://www.raidbots.com/static/images/icons/36/".concat(n.icon,".png"),className:"item-icon q".concat(n.iLvls.length>1&&s>171?n.maxQuality:n.minQuality)})}),Object(a.jsxs)("div",{className:"item-info",children:[Object(a.jsxs)("div",{className:"item-info-row",title:"".concat(n.name," (").concat(s,")"),children:[Object(a.jsx)("span",{className:"item-name",children:n.name}),Object(a.jsxs)("span",{className:"item-ilevel",children:["(",s,")"]})]}),Object(a.jsx)("div",{className:"item-info-ilevels",children:n.iLvls.length>6?Object(a.jsxs)("div",{className:"iLvl slider",children:[Object(a.jsx)("span",{children:n.miniLvl}),Object(a.jsx)(y,{item:n,setIlvl:N}),Object(a.jsx)("span",{children:n.maxiLvl})]}):n.iLvls.map((function(e,t){return Object(a.jsx)("button",{onClick:function(){return N(e)},className:"iLvl ".concat(e===s&&n.iLvls.length>1?"selected":""),children:e},t)}))})]}),x.includes(s)?Object(a.jsx)(k.a,{className:"star",onClick:function(){return S()}}):Object(a.jsx)(w.a,{className:"star",onClick:function(){return S()}})]})}function E(e){var t=e.displayData,n=e.onItemChange,c=Object(r.useState)([]),i=Object(u.a)(c,2),s=i[0],o=i[1],l=Object(r.useState)(1),b=Object(u.a)(l,2),d=b[0],j=b[1];return Object(r.useEffect)((function(){return o(t.slice(0,t.length>=20*(d+1)?20*(d+1):t.length))}),[t,d]),Object(r.useEffect)((function(){return j(1)}),[t]),Object(a.jsx)(p.a,{dataLength:s.length,next:function(){return j((function(e){return e+1}))},hasMore:d<Math.ceil(t.length/20),loader:Object(a.jsx)(g,{}),children:s?s.map((function(e,t){return Object(a.jsx)(L,{item:e,onItemChange:function(e){return n(e)}},t)})):Object(a.jsx)(g,{})})}var I=n(10);function C(e){var t=e.metaData,n=e.setFilters,c=e.setOrder,i=Object(r.useState)([]),s=Object(u.a)(i,2),o=s[0],l=s[1],b=Object(r.useState)({}),d=Object(u.a)(b,2),j=d[0],f=d[1],h=Object(r.useState)({}),p=Object(u.a)(h,2),x=p[0],g=p[1],y=Object(r.useState)(""),N=Object(u.a)(y,2),w=N[0],S=N[1],k=Object(r.useState)(!1),L=Object(u.a)(k,2),E=L[0],C=L[1],T=function(e){var t=o.findIndex((function(t){return t===e.currentTarget.value})),n=Object(O.a)(o);-1===t||e.currentTarget.checked?-1===t&&e.currentTarget.checked&&n.push(e.currentTarget.value):n.splice(t,1),l(n)},M=Object(r.useCallback)((function(e){S(e),c(e)}),[S,c]);return Object(r.useEffect)((function(){var e=localStorage.getItem("raidbots-extension-preferences");if(e){var t=JSON.parse(e);l(t.stats),g(t.type),f(t.material),C(t.legendaries),M(t.orderBy)}}),[M]),Object(r.useEffect)((function(){var e={material:j,stats:o,type:x,legendaries:E};n(e),(Object.keys(j).length>0||o.length>0||Object.keys(x).length>0||""!==w||!0===E)&&localStorage.setItem("raidbots-extension-preferences",JSON.stringify(Object(v.a)(Object(v.a)({},e),{},{orderBy:w})))}),[j,o,x,w,E,n]),Object(a.jsxs)("div",{className:"filters-area row",children:[Object(a.jsxs)(I.a,{children:[Object(a.jsx)(I.a.Toggle,{children:0===Object.keys(j).length||0===j.id?"Materials":j.label}),Object(a.jsx)(I.a.Menu,{children:t.materials.map((function(e,t){return Object(a.jsx)("button",{className:"dropdown-item",value:e.id,onClick:function(){return f(e)},children:e.label},t)}))})]}),Object(a.jsxs)(I.a,{children:[Object(a.jsx)(I.a.Toggle,{children:0===Object.keys(x).length||0===x.id?"Item type":x.label}),Object(a.jsx)(I.a.Menu,{children:t.types.map((function(e,t){return Object(a.jsx)("button",{className:"dropdown-item",value:e.id,onClick:function(){return g(e)},children:e.label},t)}))})]}),Object(a.jsxs)(I.a,{children:[Object(a.jsx)(I.a.Toggle,{children:0===o.length||0===t.stats.length?"Secondary stats":o.map((function(e){return t.stats[t.stats.findIndex((function(t){return t.id===Number(e)}))].label})).join(", ")}),Object(a.jsx)(I.a.Menu,{children:t.stats.map((function(e,t){return Object(a.jsx)(m.a.Check,{label:e.label,value:e.id,onChange:T,checked:o.includes(e.id.toString())},t)}))})]}),Object(a.jsxs)(I.a,{children:[Object(a.jsx)(I.a.Toggle,{children:"None"===w||""===w?"Order by":w}),Object(a.jsx)(I.a.Menu,{children:["None","Name","Favorites","Selected","Max iLevel","Min iLevel","Best quality","Low quality"].map((function(e,t){return Object(a.jsx)("button",{className:"dropdown-item",onClick:function(){return M(e)},children:e},t)}))})]}),Object(a.jsx)("div",{className:"legendary-filter-wrapper",children:Object(a.jsx)(m.a.Check,{id:"Legendary",className:"legendary-filter",checked:E,onChange:function(){return C(!E)},type:"checkbox",label:"Include legendary items",custom:!0})})]})}function T(e){var t=e.fetchedData,n=e.textArea,c=Object(r.useState)(""),i=Object(u.a)(c,2),s=i[0],b=i[1],d=Object(r.useState)([]),j=Object(u.a)(d,2),f=j[0],p=j[1],x=Object(r.useState)({materials:[],stats:[],types:[]}),g=Object(u.a)(x,2),y=g[0],N=g[1],w=Object(r.useState)([]),S=Object(u.a)(w,2),k=S[0],L=S[1],I=Object(r.useState)({}),T=Object(u.a)(I,2),M=T[0],D=T[1],A=Object(r.useState)(""),B=Object(u.a)(A,2),R=B[0],q=B[1],F=Object(r.useState)([]),J=Object(u.a)(F,2),Q=J[0],H=J[1],W=Object(r.useState)(!1),X=Object(u.a)(W,2),_=X[0],z=X[1],G=Object(r.useRef)();G.current=f;var P=Object(r.useState)([]),V=Object(u.a)(P,2),Y=V[0],U=V[1];function K(){return(K=Object(l.a)(o.a.mark((function e(t){var n,a,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(-1!==(n=Y.findIndex((function(e){return e.id===t.id&&Z(e.bonus,t.bonus)})))||t.favorites.length>0)&&(a=Object(O.a)(Y),-1===n&&t.favorites.length>0?a.push(t):-1!==n&&!Z(t.favorites,Y[n].favorites)&&t.favorites.length>0?a[n].favorites=t.favorites:-1!==n&&0===t.favorites.length&&a.splice(n,1),U(a)),(r=Object(O.a)(f))[f.findIndex((function(e){return e.id===t.id}))]=t,p(r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e,t){return Array.isArray(e)&&Array.isArray(t)&&e.length===t.length&&e.every((function(e,n){return e===t[n]}))}return Object(r.useEffect)((function(){var e=localStorage.getItem("raidbots-extension-favorites");e&&U(JSON.parse(e))}),[]),Object(r.useEffect)((function(){return localStorage.setItem("raidbots-extension-favorites",JSON.stringify(Y))}),[Y]),Object(r.useEffect)((function(){"items"in t&&"metaData"in t&&(p((function(){return t.items.map((function(e){var t=Q.filter((function(t){return t.id===e.id&&(0===t.bonus.length||t.bonus===e.bonus[e.iLvls.indexOf(t.iLvl)])})).map((function(e){return e.iLvl})),n=Y.find((function(t){return t.id===e.id&&Z(t.bonus,e.bonus)}));return t.length>0&&z(!0),Object(v.a)(Object(v.a)({},e),{},{iLvl:void 0!==n?Math.max.apply(Math,Object(O.a)(n.favorites)):t.length>0?Math.max.apply(Math,Object(O.a)(t)):e.iLvl,miniLvl:Math.min.apply(Math,Object(O.a)(e.iLvls)),maxiLvl:Math.max.apply(Math,Object(O.a)(e.iLvls)),selected:t.length>0?t:[],favorites:void 0!==n?n.favorites:[]})}))})),N(t.metaData))}),[t,Q,Y]),Object(r.useEffect)((function(){if(""!==n){var e=[];n.split("\n").forEach((function(t){return t.includes("# ADDED BY EXTENSION")?e.push(t.replace(" # ADDED BY EXTENSION","").split(",")):null})),H((function(){return e.map((function(e){return{id:Number(e[1].replace("id=","")),bonus:e[2].replace("bonus_id=","").replaceAll("/",":"),iLvl:Number(e[3].replace("ilevel=",""))}}))}))}}),[n]),Object(r.useEffect)((function(){var e=M.legendaries?Object(O.a)(G.current):Object(O.a)(G.current).filter((function(e){return e.minQuality<5})),t=""===s?e:!isNaN(s)&&Number.isInteger(parseFloat(s))?Object(h.search)(e,["id"],s):Object(h.search)(e,["name"],s),n=[];switch(t.forEach((function(e){void 0!==M.material.id&&0!==M.material.id&&(0===M.material.id||Number(M.material.id)!==Number(e.material))||0!==M.stats.length&&!e.stats.sort().join(";").includes(M.stats.sort().join(";"))||void 0!==M.type.id&&0!==M.type.id&&(0===M.type.id||Number(M.type.id)!==Number(e.type))||n.push(e)})),R){case"Name":n.sort((function(e,t){return e.name>t.name?1:-1}));break;case"Favorites":n.sort((function(e,t){return e.favorites.length>t.favorites.length?-1:1}));break;case"Selected":n.sort((function(e,t){return e.selected.length>t.selected.length?-1:1}));break;case"Max iLevel":n.sort((function(e,t){return e.maxiLvl<t.maxiLvl?1:-1}));break;case"Min iLevel":n.sort((function(e,t){return e.maxiLvl<t.maxiLvl?-1:1}));break;case"Best quality":n.sort((function(e,t){return e.maxQuality<t.maxQuality?1:-1}));break;case"Low quality":n.sort((function(e,t){return e.maxQuality<t.maxQuality?-1:1}))}L(n)}),[f.length,M,s,R,_]),Object(a.jsxs)("div",{className:"panel",children:[Object(a.jsx)(m.a.Group,{className:"search-area",children:Object(a.jsx)(m.a.Control,{type:"text",placeholder:"Search item(s)",name:"searchText",value:s,onChange:function(e){return b(e.currentTarget.value)},className:"search-box"})}),Object(a.jsx)(C,{metaData:y,setFilters:D,setOrder:q}),Object(a.jsx)("div",{className:"results",children:Object(a.jsx)(E,{displayData:k,onItemChange:function(e){return function(e){return K.apply(this,arguments)}(e)}})})]})}function M(){var e=Object(r.useState)({}),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)(""),s=Object(u.a)(i,2),d=s[0],O=s[1],v=Object(r.useState)(""),h=Object(u.a)(v,2),m=h[0],p=h[1],x=Object(r.useCallback)(Object(l.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("https://thekecha.com/krenier/library/raidbots-extension/data-full.json");case 3:return e.next=5,e.sent.json();case 5:t=e.sent,c(t),console.log("> NEW DATABASE FETCHED FROM THEKECHA.COM"),localStorage.setItem("raidbots-extension",JSON.stringify({timestamp:Date.now(),value:t})),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("! Impossible to fetch and store 'data.json' from https://thekecha.com"),console.log(e.t0.message);case 15:case"end":return e.stop()}}),e,null,[[0,11]])}))),[c]),g=Object(r.useCallback)(Object(l.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!(t=localStorage.getItem("raidbots-extension"))){e.next=8;break}if(n=JSON.parse(t),!(Date.now()-n.timestamp<72e5)){e.next=8;break}return c(n.value),console.log("> DATABASE ACQUIRED FROM LOCAL STORAGE"),e.abrupt("return");case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("! Couldn't retrieve data from browser local storage..."),console.log(e.t0.message);case 14:x();case 15:case"end":return e.stop()}}),e,null,[[0,10]])}))),[x]);return Object(r.useEffect)((function(){g();var e=setInterval((function(){return e=function(e){return O(void 0!==e&&e.toLowerCase().includes("simbot/topgear")?"topgear":"")},void(b&&["tabs"]in b&&b.tabs.query({active:!0,lastFocusedWindow:!0},(function(t){return e(t.length>0&&["url"]in t[0]?t[0].url:"")})));var e}),[800]);return function(){return clearInterval(e)}}),[g]),Object(r.useEffect)((function(){var e;"topgear"===d&&(console.log("> HISTORICAL RECORDS EXTRACTED FROM RAIDBOTS.COM"),e=function(e){return p(e)},b&&["tabs"]in b?b.tabs.query({active:!0,currentWindow:!0},(function(t){b.tabs.executeScript(t[0].id,{code:"var callMeBack = () => {\n            try{\n              var box = document.querySelector('textarea')\n              if (box && box.name === 'optimizeInput') {\n                return box.value\n              }\n              return ''\n            } catch (err) {\n              return ''\n            }\n          } \n        callMeBack()"},(function(t){return e(void 0===t||void 0===t[0]?"":t[0])}))})):e(""))}),[d]),Object(a.jsxs)("div",{className:"app",children:[Object(a.jsxs)("div",{className:"copyright",children:["Designed by"," ",Object(a.jsx)("a",{onClick:j,href:"https://github.com/Tcheetox",target:"_blank",rel:"noreferrer",children:"Tcheetox"})," ","to enjoy"," ",Object(a.jsx)("a",{onClick:j,href:"https://www.raidbots.com",target:"_blank",rel:"noreferrer",children:"Raidbots.com"})," ",Object(a.jsx)("span",{className:"affiliation",children:"- Non-affiliated with Raidbots"})]}),Object(a.jsx)("div",{className:"raidbots-links ".concat(""!==d?"active":"inactive"),children:Object(a.jsx)("a",{onClick:f,href:"https://www.raidbots.com/simbot/topgear",children:Object(a.jsx)("div",{className:"link ".concat(""!==d?"active":"inactive"),children:"Top gear"})})}),Object(a.jsx)(T,{fetchedData:n,textArea:m})]})}i.a.render(Object(a.jsx)(M,{}),document.getElementById("root"))}},[[52,1,2]]]);